<odoo>
    <data>
        <record id="view_task_search_form_inherit" model="ir.ui.view">
            <field name="name">project.task.search.form</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="project.view_task_search_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='stage_id']" position="after">
                    <filter string="Waiting Audit Tasks" name="waiting_audit_tasks"
                            domain="[('kanban_state','=','audit'),('reviewer_id','=',uid)]"/>
                </xpath>
            </field>
        </record>

        <record id="view_project_project_gantt" model="ir.ui.view">
            <field name="name">project.project.gantt</field>
            <field name="model">project.project</field>
            <field name="arch" type="xml">
                <gantt date_start="date_start" date_stop="date" progress="progress_rate" string="Projects">
                </gantt>
            </field>
        </record>


        <record id="project.open_create_project" model="ir.actions.act_window">
            <field name="name">Create a Project</field>
            <field name="res_model">project.project</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="view_id" ref="project.edit_project"/>
            <field name="target">current</field>
        </record>

        <record id="project.open_view_project_all" model="ir.actions.act_window">
            <field name="name">Projects</field>
            <field name="res_model">project.project</field>
            <field name="view_type">form</field>
            <field name="domain">[]</field>
            <field name="view_mode">kanban,form,gantt</field>
            <field name="search_view_id" ref="project.view_project_project_filter"/>
            <field name="target">main</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a new project.
                    <br/>
                    <i>Or <a type="action" name="%(project.activate_sample_project)d">activate a sample project</a> to
                        play with.
                    </i>
                </p>
            </field>
        </record>
        <record id="act_project_project_2_project_task_waiting_audit" model="ir.actions.act_window">
            <field name="name">Waiting Audit Tasks</field>
            <field name="res_model">project.task</field>
            <field name="view_mode">kanban,tree,form,calendar,pivot,graph</field>
            <field name="context">{
                'search_default_waiting_audit_tasks': 1,
                }
            </field>
            <field name="search_view_id" ref="project.view_task_search_form"/>
            <field name="help" type="html">
                <p>
                    Odoo's project management allows you to manage the pipeline of your tasks efficiently. You can track
                    progress, discuss on tasks, attach documents, etc.
                </p>
            </field>
        </record>

        <record id="act_project_project_2_project_task_human_resources" model="ir.actions.act_window">
            <field name="name">Human Resources</field>
            <field name="res_model">project.task</field>
            <field name="view_mode">gantt</field>
            <field name="context">{
                'group_by': 'user_id',
                }
            </field>
            <field name="search_view_id" ref="project.view_task_search_form"/>
            <field name="help" type="html">
                <p>
                    Odoo's project management allows you to manage the pipeline of your tasks efficiently. You can track
                    progress, discuss on tasks, attach documents, etc.
                </p>
            </field>
        </record>

        <record id="project.act_project_project_2_project_task_all" model="ir.actions.act_window">
            <field name="name">Tasks</field>
            <field name="res_model">project.task</field>
            <field name="view_mode">kanban,tree,form,calendar,pivot,gantt</field>
            <field name="context">{
                'group_by': 'stage_id',
                'search_default_project_id': [active_id],
                'default_project_id': active_id,
                }
            </field>
            <field name="domain">[('parent_ids','=',False)]</field>
            <field name="search_view_id" ref="project.view_task_search_form"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Here, you can create new tasks
                </p>
                <p>
                    You can now manage your tasks in order to get things done efficiently. Track progress, discuss,
                    attach documents, etc.
                </p>
            </field>
        </record>


        <record id="project.edit_project" model="ir.ui.view">
            <field name="name">project.project.form</field>
            <field name="model">project.project</field>
            <field name="arch" type="xml">
                <form string="Project">
                    <header>
                        <button name="set_open" string="Re-open project" type="object" states="pending"
                                class="oe_highlight" groups="base.group_user"/>
                        <button name="set_done" string="Close Project" type="object" states="open,pending"
                                groups="base.group_user"/>
                        <button name="set_open" string="Re-open project" type="object" states="cancelled,close"
                                groups="base.group_user"/>
                        <button name="set_pending" string="Pending" type="object" states="open"
                                groups="base.group_user"/>
                        <button name="set_template" string="Set as Template" type="object" states="open"
                                groups="base.group_user"/>
                        <button string="New Project Based on Template" name="duplicate_template" type="object"
                                states="template" context="{'parent_id':parent_id}" class="oe_highlight"
                                groups="base.group_user"/>
                        <button name="reset_project" string="Reset as Project" type="object" states="template"
                                class="oe_highlight" groups="base.group_user"/>
                        <button name="set_cancel" string="Cancel Project" type="object" states="open,pending"
                                groups="base.group_user"/>
                        <field name="state" widget="statusbar" statusbar_visible="open,close"
                               statusbar_colors='{"pending":"blue"}' readonly="1"/>
                    </header>
                    <sheet string="Project">
                        <div class="oe_button_box" name="button_box">
                            <button name="toggle_active" type="object" groups="base.group_user"
                                    class="oe_stat_button" icon="fa-archive">
                                <field name="active" widget="boolean_button"
                                       options='{"terminology": "archive"}'/>
                            </button>
                        </div>
                        <field name="analytic_account_id" invisible="1" required="0"/>
                        <div class="oe_title">
                            <label for="name" class="oe_edit_only" string="Project Name"/>
                            <h1>
                                <field name="name" string="Project Name"/>
                            </h1>
                            <div name="options_active">
                                <field name="use_tasks" class="oe_inline"/>
                                <label for="use_tasks" string="Use Tasks"/>
                            </div>
                        </div>
                        <div class="oe_right oe_button_box" name="buttons" groups="base.group_user">
                            <button class="oe_inline oe_stat_button" type="action"
                                    attrs="{'invisible':[('use_tasks','=', 0)]}"
                                    name="%(project.act_project_project_2_project_task_all)d" icon="fa-tasks">
                                <field string="Tasks" name="task_count" widget="statinfo"/>
                            </button>
                            <button class="oe_inline oe_stat_button" name="attachment_tree_view" type="object"
                                    icon="fa-files-o">
                                <field string="Documents" name="doc_count" widget="statinfo"/>
                            </button>
                        </div>
                        <group>
                            <group col="4">
                                <field name="user_id" string="Project Manager"
                                       attrs="{'readonly':[('state','in',['close', 'cancelled'])]}"
                                       context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'project.group_project_manager']}"/>
                                <newline/>
                                <field name="partner_id" string="Customer"/>
                            </group>
                            <p attrs="{'invisible': [('analytic_account_id','=',False)]}">
                                To invoice or setup invoicing and renewal options, go to the related contract:
                                <field name="analytic_account_id" readonly="1" required="0" class="oe_inline"
                                       nolabel="1"/>.
                            </p>
                            <group name="group_alias"
                                   attrs="{'invisible': [('alias_domain', '=', False)]}">
                                <label for="alias_name" string="Email Alias"/>
                                <div name="alias_def">
                                    <field name="alias_id" class="oe_read_only oe_inline"
                                           string="Email Alias" required="0"/>
                                    <div class="oe_edit_only oe_inline" name="edit_alias" style="display: inline;">
                                        <field name="alias_name" class="oe_inline"/>@
                                        <field name="alias_domain" class="oe_inline" readonly="1"/>
                                    </div>
                                </div>
                                <label for="alias_model" string="Incoming Emails create"/>
                                <field name="alias_model" class="oe_inline" nolabel="1"/>
                                <field name="alias_contact" class="oe_inline"
                                       string="Accept Emails From"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Team" name="team">
                                <field colspan="4" name="members" widget="many2many_kanban"
                                       context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'project.group_project_user']}">
                                    <kanban quick_create="false" create="true" delete="true">
                                        <field name="name"/>
                                        <templates>
                                            <t t-name="kanban-box">
                                                <div style="position: relative">
                                                    <a t-if="! read_only_mode" type="delete"
                                                       style="position: absolute; right: 0; padding: 4px; diplay: inline-block">
                                                        X
                                                    </a>
                                                    <div class="oe_module_vignette">
                                                        <img t-att-src="kanban_image('res.users', 'image_small', record.id.value)"
                                                             class="oe_avatar oe_kanban_avatar_smallbox"/>
                                                        <div class="oe_module_desc">
                                                            <field name="name"/>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </templates>
                                    </kanban>
                                </field>
                            </page>
                            <page string="Other Info">
                                <group string="Administration">
                                    <field name="privacy_visibility" widget="radio"/>
                                    <field name="planned_hours" widget="float_time"
                                           groups="project.group_time_work_estimation_tasks"/>
                                    <field name="effective_hours" widget="float_time"
                                           groups="project.group_time_work_estimation_tasks"/>
                                    <field name="resource_calendar_id"
                                           groups="project.group_time_work_estimation_tasks"/>
                                </group>
                                <group string="Miscellaneous" name="misc">
                                    <field name="date_start" string="Start Date"/>
                                    <field name="date" string="End Date"/>
                                    <field name="sequence" groups="base.group_no_one"/>
                                    <field name="active"
                                           attrs="{'invisible':[('state','in',['open', 'pending', 'template'])]}"/>
                                    <field name="currency_id" groups="base.group_multi_currency" required="1"/>
                                    <field name="parent_id" string="Parent"
                                           help="Append this project to another one using analytic accounts hierarchy"
                                           domain="[('id','!=',analytic_account_id)]"
                                           context="{'current_model': 'project.project'}"/>
                                </group>
                            </page>
                            <page string="Project Stages" attrs="{'invisible': [('use_tasks', '=', False)]}"
                                  name="project_stages">
                                <field name="type_ids"/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers"
                               help="Follow this project to automatically track the events associated to tasks and issues of this project."
                               groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>


        <record id="project.view_project" model="ir.ui.view">
            <field name="name">project.project.tree</field>
            <field name="model">project.project</field>
            <field name="field_parent">child_ids</field>
            <field name="arch" type="xml">
                <tree fonts="bold:message_unread==True"
                      colors="red:date and (date&lt;current_date) and (state == 'open');blue:state in ('draft','pending');grey: state in ('close','cancelled')"
                      string="Projects">
                    <field name="sequence" widget="handle"/>
                    <field name="message_unread" invisible="1"/>
                    <field name="date" invisible="1"/>
                    <field name="name" string="Project Name"/>
                    <field name="user_id" string="Project Manager"/>
                    <field name="partner_id" string="Contact"/>
                    <field name="parent_id" string="Parent" invisible="1"/>
                    <field name="planned_hours" widget="float_time"/>
                    <field name="total_hours" widget="float_time"/>
                    <field name="effective_hours" widget="float_time"/>
                    <field name="progress_rate" widget="progressbar"/>
                    <field name="state"/>
                </tree>
            </field>
        </record>

        <record id="open_view_template_project" model="ir.actions.act_window">
            <field name="name">Templates of Projects</field>
            <field name="res_model">project.project</field>
            <field name="view_type">form</field>
            <field name="domain">[('state','=','template')]</field>
            <field name="view_id" ref="project.view_project"/>
        </record>


        <record id="view_task_work_form" model="ir.ui.view">
            <field name="name">project.task.work.form</field>
            <field name="model">project.task.work</field>
            <field name="arch" type="xml">
                <form string="Task Work">
                    <group col="4">
                        <field colspan="4" name="name"/>
                        <field name="hours" widget="float_time"/>
                        <field name="date"/>
                        <field name="user_id" options='{"no_open": True}'
                               context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'base.group_partner_manager', 'project.group_project_user']}"/>
                        <field name="company_id" groups="base.group_multi_company" widget="selection"/>
                    </group>
                </form>
            </field>
        </record>

        <record id="view_task_work_tree" model="ir.ui.view">
            <field name="name">project.task.work.tree</field>
            <field name="model">project.task.work</field>
            <field name="arch" type="xml">
                <tree editable="top" string="Task Work">
                    <field name="date"/>
                    <field name="name"/>
                    <field name="hours" widget="float_time"/>
                    <field name="user_id"
                           context="{'default_groups_ref': ['base.group_user', 'project.group_project_user']}"/>
                </tree>
            </field>
        </record>

        <!-- Task-->
        <record id="project.view_task_form2" model="ir.ui.view">
            <field name="name">project.task.form</field>
            <field name="model">project.task</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <form string="Project">
                    <header>
                        <field name="stage_id" widget="statusbar" readonly="1"
                               options="{'fold_field': 'fold'}"/>
                    </header>
                    <sheet string="Task">
                        <div class="oe_right">
                            <field name="kanban_state" class="oe_inline" widget="kanban_state_selection"/>
                        </div>
                        <h1>
                            <field name="display_name"/>
                            <field name="name" placeholder="Task summary..." class="oe_inline"/>
                        </h1>
                        <group>
                            <group>
                                <field name="partner_id" invisible="1"/>
                                <field name="project_id" domain="[('state','not in', ('close', 'cancelled'))]"
                                       context="{'default_use_tasks':1}"/>
                                <field name="user_id"
                                       options='{"no_open": True}'
                                       context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'project.group_project_user']}"/>
                                <field name="reviewer_id"
                                       options='{"no_open": True}'
                                       context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'project.group_project_user']}"/>
                                <!--<field name="planned_hours" widget="float_time" />-->
                                <field name="planed_level" widget="priority"
                                       attrs="{'invisible':[('kanban_state','!=','done')]}"/>
                                <field name="actual_level" widget="priority"
                                       attrs="{'invisible':[('kanban_state','!=','done')]}"/>
                                s
                            </group>
                            <group>
                                <!--<field name="date_deadline"/>-->
                                <field name="date_start"/>
                                <field name="date_end"/>
                                <field name="tag_ids" widget="many2many_tags"/>
                                <field name="task_progress" widget="progressbar"/>
                                <field name="progress" widget="progressbar"
                                       groups="project.group_time_work_estimation_tasks"/>
                            </group>
                        </group>
                        <notebook>
                            <page string="Description">
                                <field name="description" placeholder="Add a Description..."/>
                                <!--groups="project.group_tasks_work_on_tasks"-->
                                <field name="work_ids" attrs="{'readonly':[('kanban_state','in',['close'])]}"
                                       delete="false">
                                    <tree string="Task Work" editable="top">
                                        <field name="name"/>
                                        <field name="progress" string="progress (%)"/>
                                        <field name="date"/>
                                        <field name="user_id"
                                               context="{'default_groups_ref': ['base.group_user', 'base.group_partner_manager', 'project.group_project_user']}"/>
                                    </tree>
                                </field>
                                <group>
                                    <group class="oe_subtotal_footer oe_right" name="project_hours"
                                           groups="project.group_time_work_estimation_tasks">
                                        <field name="effective_hours" widget="float_time"/>
                                        <label for="remaining_hours" string="Remaining"
                                               groups="project.group_time_work_estimation_tasks"/>
                                        <div>
                                            <field name="remaining_hours" widget="float_time"
                                                   groups="project.group_time_work_estimation_tasks"/>
                                        </div>
                                        <field name="total_hours" widget="float_time"
                                               class="oe_subtotal_footer_separator"/>
                                    </group>
                                </group>
                                <div class="oe_clear"/>
                            </page>
                            <!--groups="group_delegate_task"-->
                            <page string="Delegation">
                                <separator string="Delegated tasks"/>
                                <field name="child_ids" domain="[('project_id','=',project_id),('top_task_id','=',0)]"
                                       context="{'default_project_id': project_id, 'default_stage_id': stage_id}">
                                    <tree string="Delegated tasks">
                                        <field name="name"/>
                                        <field name="user_id"/>
                                        <field name="stage_id"/>
                                        <!--<field name="effective_hours" widget="float_time"/>-->
                                        <field name="task_progress" widget="progressbar"/>
                                        <field name="date_end"/>
                                        <!--<field name="remaining_hours" widget="float_time"/>-->
                                    </tree>
                                </field>
                            </page>
                            <!--<page string="Extra Info">-->
                            <!--<group col="4">-->
                            <!--<field name="priority" groups="base.group_user" widget="priority"/>-->
                            <!--<field name="sequence"/>-->
                            <!--<field name="partner_id"/>-->
                            <!--<field name="company_id" groups="base.group_multi_company" widget="selection"/>-->
                            <!--</group>-->
                            <!--<group>-->
                            <!--<group string="Gantt View">-->
                            <!--<field name="date_start"/>-->
                            <!--<field name="date_end"/>-->
                            <!--</group>-->
                            <!--<group>-->
                            <!--<field name="date_last_stage_update" groups="base.group_no_one"/>-->
                            <!--</group>-->
                            <!--</group>-->
                            <!--</page>-->
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread"/>
                    </div>
                </form>
            </field>
        </record>


        <record id="project.view_task_tree2" model="ir.ui.view">
            <field name="name">project.task.tree</field>
            <field name="model">project.task</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <tree fonts="bold:message_unread==True" colors="red:date_deadline and (date_deadline&lt;current_date)"
                      string="Tasks">
                    <field name="message_unread" invisible="1"/>
                    <field name="sequence" invisible="not context.get('seq_visible', False)"/>
                    <field name="name"/>
                    <field name="project_id" invisible="context.get('user_invisible', False)"/>
                    <field name="user_id" invisible="context.get('user_invisible', False)"/>
                    <field name="delegated_user_id" invisible="context.get('show_delegated', True)"/>
                    <field name="total_hours" invisible="1"/>
                    <field name="planned_hours" invisible="context.get('set_visible',False)"
                           groups="project.group_time_work_estimation_tasks"/>
                    <field name="effective_hours" widget="float_time" sum="Spent Hours" invisible="1"/>
                    <!--on_change="onchange_remaining(remaining_hours,planned_hours)"-->
                    <field name="remaining_hours" widget="float_time" sum="Remaining Hours"

                           invisible="context.get('set_visible',False)"
                           groups="project.group_time_work_estimation_tasks"/>
                    <field name="date_deadline" invisible="context.get('deadline_visible',True)"/>
                    <field name="stage_id" invisible="context.get('set_visible',False)"/>
                    <field name="date_start" groups=""/>
                    <field name="date_end" groups=""/>
                    <field name="progress" widget="progressbar" invisible="context.get('set_visible',False)"/>
                </tree>
            </field>
        </record>

        <record id="view_task_kanban_inherit" model="ir.ui.view">
            <field name="name">project.task.kanban</field>
            <field name="model">project.task</field>
            <field name="inherit_id" ref="project.view_task_kanban"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='legend_normal']" position="after">
                    <field name="legend_audit"/>
                    <field name="legend_close"/>
                    <field name="legend_pending"/>
                </xpath>
            </field>
        </record>

        <record id="view_task_gantt" model="ir.ui.view">
            <field name="name">project.task.gantt11111</field>
            <field name="model">project.task</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <gantt date_start="date_start" date_stop="date_end" progress="task_progress" string="Tasks"
                       parent_ids="parent_ids" child_ids="child_ids" stage_id="stage_id" top_task_id="top_task_id"
                       after_task_id="after_task_id"
                       default_group_by="top_task_id">
                </gantt>
            </field>
        </record>

        <record id="view_task_new_wangke" model="ir.ui.view">
            <field name="name">project.task.wangke2222</field>
            <field name="model">project.task</field>
            <field eval="2" name="priority"/>
            <field name="arch" type="xml">
                <wangke date_start="date_start" date_stop="date_end" progress="task_progress" string="Tasks"
                        parent_ids="parent_ids" child_ids="child_ids" stage_id="stage_id" top_task_id="top_task_id"
                        after_task_id="after_task_id"
                        default_group_by="top_task_id">
                </wangke>
            </field>
        </record>

        <record id="project_category_action" model="ir.actions.act_window">
            <field name="name">Tags</field>
            <field name="res_model">project.category</field>
            <field name="view_type">form</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to add a new tag.
                </p>
            </field>
        </record>

        <record id="show_new_gantt" model="ir.actions.act_window">
            <field name="name">Show All Projects</field>
            <field name="res_model">project.task</field>
            <field name="view_mode">wangke</field>
            <field name="context">{
                'group_by': 'user_id',
                }
            </field>
            <field name="search_view_id" ref="project.view_task_search_form"/>
            <field name="help" type="html">
                <p>
                    Odoo's project management allows you to manage the pipeline of your tasks efficiently. You can track
                    progress, discuss on tasks, attach documents, etc.
                </p>
            </field>
        </record>

        <menuitem action="project_category_action" id="menu_project_category_act" parent="base.menu_definitions"
                  groups="base.group_no_one"/>

        <menuitem id="menu_action_view_waiting_audit_task"
                  name="Waiting Audit Tasks"
                  action="act_project_project_2_project_task_waiting_audit"
                  parent="project.menu_project_management"
                  sequence="11"/>

        <menuitem id="menu_action_view_human_resources"
                  name="Human Resources"
                  action="act_project_project_2_project_task_human_resources"
                  parent="project.menu_project_management"
                  sequence="12"/>

        <menuitem id="menu_action_view_new_gantt"
                  name="test_new_gantt"
                  action="show_new_gantt"
                  parent="project.menu_project_management"
                  sequence="13"/>


    </data>


</odoo>