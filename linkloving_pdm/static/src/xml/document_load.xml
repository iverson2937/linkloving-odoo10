<?xml version="1.0" encoding="UTF-8"?>

<templates xml:space="preserve">
    <t t-name="document_load_page">
        <div class="document_page_container">

        </div>
        <!--<script>-->
        <!--console.log($(".document_page_container"))-->
        <!--$(".document_page_container").parents(".o_main_content").find(".o_cp_searchview").hide();-->
        <!--$(".document_page_container").parents(".o_main_content").find(".o_cp_left").hide();-->
        <!--$(".document_page_container").parents(".o_main_content").find(".o_cp_right").hide();-->
        <!--</script>-->
    </t>

    <t t-name="document_load_detail">
         <script>
            $(function () { $("[data-toggle='tooltip']").tooltip(); });
        </script>
        <ul id="document_tab" class="nav nav-tabs" data-now-tab="sip">
            <t t-set="i" t-value="1"/>
            <t t-foreach="result" t-as="item">
                <li t-att-class="i ==1 ? 'active': ''">
                    <a t-att-href="'#'+item.type" data-toggle="tab" class="tab_toggle_a" t-att-data="item.type" t-att-load_type="item.upload_type">
                         <t t-esc="item.name"/>
                    </a>
                </li>
                <t t-set="i" t-value="2"/>
            </t>
        </ul>
            <div class="create_document">

                <input type="checkbox" id="top_all_checkbox" class="document_all_checkbox">全选</input>
                <button class="btn btn-primary create_document_btn">创建</button>

                <button style="display:none;" class="btn btn-primary delect_hide delect_document_checked">批量删除</button>
            </div>

        <div id="myTabContent" class="tab-content">
            <t t-set="j" t-value="1"/>
            <t t-foreach="result" t-as="item">
                <div t-att-class="j==1?'tab-pane fade in active':'tab-pane fade'" t-att-id="item.type">
                    <t t-if="item.files">
                        <t t-foreach="item.files" t-as="item_files">
                            <div class="tab_pane_display" t-att-data-id="item_files.id">
                                <div class="tab_message_display">


                                    <t t-if="item_files.checkbox_type != 'submitted' ">
                                        <div id="div_file_checkbox">
                                            <input id="file_checkbox" type="checkbox" class="o_chat_header_file" t-att-name="item_files.id">选中</input>
                                        </div>
                                    </t>


                                    <div>产品名字：<span t-att-product-id="item_files.product_id.id" class="approval_product_name"><t t-esc="item_files.product_id.name"/></span></div>

                                    <div>文件：<span><t t-esc="item_files.file_name"/></span></div>
                                    <!--<div>审核人：<span><t t-esc="item_files.review_id"/></span></div>-->
                                    <t t-if="item_files.remote_path!=''">
                                        <div>远程地址：<span class="remote_path"><t t-esc="item_files.remote_path"/></span></div>
                                    </t>
                                    <div>版本：<span class="version_span"><t t-esc="item_files.version"/></span></div>
                                    <div>状态：<span><t t-esc="item_files.state[1]"/></span>
                                        <t t-if="item_files.is_show_cancel">
                                            <button class="btn btn-primary review_cancel">取消审核</button>
                                        </t>
                                    </div>
                                    <!--<div>创建人：<span><t t-esc="item_files.create_uid_name"/></span></div>-->
                                    <!--<div>-->
                                    <!---->
                                    <!--</div>-->
                                </div>
                                <div class="document_review_list">
                                    <t t-foreach="item_files.review_line" t-as="review_list">
                                        <div data-html="true" data-toggle="tooltip" data-placement="top" t-att-title="'备注:'+review_list.remark+'审核结果：'+review_list.state[1]+'，时间：'+review_list.create_date"><t t-esc="review_list.name"/></div>

                                        <t t-if="review_list.state[0]=='review_success'">
                                            <span class="fa fa-long-arrow-right" data-toggle="tooltip" data-placement="top" t-att-title="'备注:'+review_list.remark+',审核结果：'+review_list.state[1]+'，时间：'+review_list.create_date"></span>
                                        </t>
                                        <t t-if="review_list.state[0]=='waiting_review'">
                                            <span class="fa fa-long-arrow-right document_yellow" data-toggle="tooltip" data-placement="top" t-att-title="'备注:'+review_list.remark+',审核结果：'+review_list.state[1]+'，时间：'+review_list.create_date"></span>
                                            <div data-toggle="tooltip" data-placement="top" t-att-title="'备注:'+review_list.remark+',审核结果：'+review_list.state[1]+'，时间：'+review_list.create_date">等待</div>
                                        </t>
                                         <t t-if="review_list.state[0]=='review_fail'||review_list.state[0]=='review_canceled'">
                                            <span class="fa fa-long-arrow-right document_red" data-toggle="tooltip" data-placement="top" t-att-title="'备注:'+review_list.remark+',审核结果：'+review_list.state[1]+'，时间：'+review_list.create_date"></span>
                                             <!--<div>审核不通过</div>-->
                                        </t>
                                    </t>


                                    <t t-set="data_check" t-value="item_files.review_id ? false : true"/>

                                    <t t-if="data_check">
                                        <div data-toggle="tooltip" data-placement="top" t-att-title="'审核'"><t t-esc="item_files.create_uid_name"/></div>
                                        <span class="fa fa-long-arrow-right" data-toggle="tooltip" data-placement="top" t-att-title="'审核'"></span>
                                    </t>


                                    <t t-if="item_files.state[0] == 'released'">
                                         <div><t t-esc="item_files.state[1]" /></div>
                                    </t>

                                </div>
                                <div class="document_btns">
                                    <t t-if="item_files.has_right_to_review == true || item_files.is_first_review == true">
                                        <button class="btn btn-primary document_manage_btn" t-att-data-suibian="item_files.is_show_action_deny" t-att-data-id="item_files.id">审核操作</button>
                                    </t>
                                    <t t-if="item_files.state[0] == 'draft' || item_files.state[0] == 'waiting_release'||item_files.state[0] == 'deny'||item_files.state[0]=='cancel' ">
                                        <t t-if="item_files.is_delect_view =='yes' &amp;&amp;  item_files.is_show_outage == true ">
                                            <t t-if="item_files.type == 'Other' || item_files.type == 'Design'">
                                                <a href="javascript:;" class="document_modify_wraper document_modify_2" >文件修改
                                                </a>
                                            </t>
                                            <t t-else="">
                                                <a href="javascript:;" class="document_modify_wraper">文件修改
                                                <input type="file" class="document_modify"/>
                                                </a>
                                            </t>
                                        </t>
                                    </t>
                                    <!--<t t-if="item_files.is_able_to_use == true || approval_type=='waiting_submit' ||approval_type=='waiting_approval'">-->
                                    <t t-if="item_files.state[0] == 'released' || approval_type=='waiting_submit' ||approval_type=='waiting_approval'">
                                        <t t-if="item_files.is_show_outage == true ">
                                            <button class="btn btn-primary document_download" t-att-data="item_files.type">下载</button>
                                        </t>
                                    </t>


                                    <a t-attf-href="/selectfile/file_show?id=#{item_files.id}&amp;type=#{item_files.type}"
                                                               target="_blank"> <button class="btn btn-primary get_version_history">查看历史版本</button></a>
                                    <t t-if="item_files.has_right_to_review == true || item_files.is_first_review == true">
                                        <t t-if="item_files.is_delect_view =='yes'">
                                            <div class="delect_one_document" style="padding-top: 6px;">
                                                <button class="btn btn-primary delect_document_checked">删除</button>
                                            </div>
                                        </t>
                                    </t>

                                   <t t-if="item_files.state[0] == 'released' ">

                                        <div class="stop_one_document" style="padding-top: 6px;">
                                             <t t-if="item_files.is_show_outage == true ">
                                                 <button class="btn btn-primary outage_document_file off" data="off">停用</button>
                                                 <span style="color:red;">使用中</span>
                                             </t>
                                            <t t-if="item_files.is_show_outage == false ">
                                                <button class="btn btn-primary outage_document_file on" data="on">启用</button>
                                                <span style="color:red;">已停用</span>
                                             </t>
                                        </div>
                                    </t>

                                </div>
                            </div>
                        </t>
                    </t>

                </div>
                <t t-set="j" t-value="2"/>
            </t>
        </div>

        <!--上传文件界面-->
        <div class="load_container">
            <div class="load_wraper">
                <div class="load_top_close">
                    <span class="fa fa-close load_container_close"></span>
                </div>
                <div class="input_messages">
                    <div>
                        <p>文件名：</p>
                        <!--<p>远程路径：</p>-->
                        <p>上传文件：</p>
                        <!--<p>版本号：</p>-->
                    </div>
                    <form enctype="multipart/form-data" action="/linkloving_pdm/upload_attachment_info" method="post" target="id_iframe" id="document_form">
                        <input type="hidden" name="csrf_token" t-att-value="csrf_token"/>
                        <input type="hidden" class="file_func" name="func"/>
                        <input type="hidden" class="file_active_id" name="active_id" value=""/>
                        <input type="hidden" class="file_active_type" name="active_type"/>
                        <input type="text" class="my_load_file_name" name="my_load_file_name"/>
                        <input type="hidden" class="my_load_file_remote_path" name="my_load_file_remote_path" value=""/>
                        <input type="hidden" class="" name="my_load_file_version" value=""/>
                        <!--<input type="text" class="my_load_file_remote_path" name="my_load_file_remote_path"/>-->
                        <!--<t t-if=""-->

                         <a id="my_load_file__a_1"  href="javascript:void(-1);">选择文件
                             <!--<input type="file" class="my_load_file" name="my_load_file"/>-->
                        </a>

                        <a href="javascript:;" id="my_load_file_a">选择文件
                            <input type="file" class="my_load_file" name="my_load_file"/>
                        </a>
                        <!--<input type="text" class="my_load_file_version" name="my_load_file_version"/>-->
                        <input type="submit" value="提交" class="btn btn-info submit_file_yes"/>
                    </form>
                    <iframe id="id_iframe" name="id_iframe" style="display:none;"></iframe>
                </div>
                <div class="load_remark">(仅支持上传单个文件；如有多个文件，请打包为zip文件)</div>
                 <div class="submit_file">
                    <!--<button class="btn btn-info submit_file_yes">上传</button>-->
                    <button class="btn btn-default submit_file_no">取消</button>
                </div>
            </div>
        </div>
    </t>

    <t t-name="active_document_tab">
        <script>
            $(function () { $("[data-toggle='tooltip']").tooltip(); });
        </script>
        <t t-foreach="result.files" t-as="item_files">
            <div class="tab_pane_display" t-att-data-id="item_files.id">
                <div class="tab_message_display">

                    <t t-if="item_files.checkbox_type != 'submitted' ">
                        <div id="div_file_checkbox">
                            <input id="file_checkbox" type="checkbox" class="o_chat_header_file" t-att-name="item_files.id">选中</input>
                        </div>
                    </t>

                    <div>产品名字：<span t-att-product-id="item_files.product_id.id" class="approval_product_name"><t t-esc="item_files.product_id.name"/></span></div>
                    <div>文件：<span><t t-esc="item_files.file_name"/></span></div>
                    <!--<div>审核人：<span><t t-esc="item_files.review_id"/></span></div>-->
                    <t t-if="item_files.remote_path!=''">
                        <div>远程地址：<span class="remote_path"><t t-esc="item_files.remote_path"/></span></div>
                    </t>
                    <div>版本：<span class="version_span"><t t-esc="item_files.version"/></span></div>
                    <div>状态：<span><t t-esc="item_files.state[1]"/></span>
                                        <t t-if="item_files.is_show_cancel">
                                            <button class="btn btn-primary review_cancel" >取消审核</button>
                                        </t>
                                    </div>
                    <!--<div>创建人：<span><t t-esc="item_files.create_uid_name"/></span></div>-->
                </div>
                 <div class="document_review_list">
                    <t t-foreach="item_files.review_line" t-as="review_list">
                        <div data-toggle="tooltip" data-placement="top" t-att-title="'备注:'+review_list.remark+',审核结果：'+review_list.state[1]+'时间：'+review_list.create_date"><t t-esc="review_list.name"/></div>
                        <t t-if="review_list.state[0]=='review_success'">
                            <span class="fa fa-long-arrow-right document_yellow_dialog_pdm" data-toggle="tooltip" data-placement="top" t-att-title="'备注:'+review_list.remark+'审核结果：'+review_list.state[1]+'，时间：'+review_list.create_date"></span>
                        </t>
                        <t t-if="review_list.state[0]=='waiting_review'">
                            <span class="fa fa-long-arrow-right document_yellow document_yellow_dialog_pdm" data-toggle="tooltip" data-placement="top" t-att-title="'备注:'+review_list.remark+',审核结果：'+review_list.state[1]+'，时间：'+review_list.create_date"></span>
                            <div data-toggle="tooltip" data-placement="top" t-att-title="'备注:'+review_list.remark+',审核结果：'+review_list.state[1]+'，时间：'+review_list.create_date">等待</div>
                        </t>
                         <t t-if="review_list.state[0]=='review_fail'||review_list.state[0]=='review_canceled'">
                            <span class="fa fa-long-arrow-right document_red document_yellow_dialog_pdm" data-toggle="tooltip" data-placement="top" t-att-title="'备注:'+review_list.remark+',审核结果：'+review_list.state[1]+'，时间：'+review_list.create_date"></span>
                             <!--<div>审核不通过</div>-->
                        </t>
                    </t>

                     <t t-set="data_check" t-value="item_files.review_id ? false : true"/>

                     <t t-if="data_check">
                         <div data-toggle="tooltip" data-placement="top" t-att-title="'审核'"><t t-esc="item_files.create_uid_name"/></div>
                         <span class="fa fa-long-arrow-right" data-toggle="tooltip" data-placement="top" t-att-title="'审核'"></span>
                     </t>


                     <t t-if="item_files.state[0] == 'released'">
                        <div><t t-esc="item_files.state[1]" /></div>
                    </t>

                 </div>
                <div class="document_btns">
                    <t t-if="item_files.has_right_to_review == true || item_files.is_first_review == true">
                        <button class="btn btn-primary document_manage_btn" t-att-data-suibian="item_files.is_show_action_deny" t-att-data-id="item_files.id">审核操作</button>
                    </t>
                    <t t-if="item_files.state[0] == 'draft' || item_files.state[0] == 'waiting_release'||item_files.state[0] == 'deny'||item_files.state[0]=='cancel' ">
                        <t t-if="item_files.is_delect_view =='yes' &amp;&amp;  item_files.is_show_outage == true ">
                            <t t-if="item_files.type == 'Other' || item_files.type == 'Design'">
                                <a href="javascript:;" class="document_modify_wraper document_modify_2" >文件修改
                                </a>
                            </t>
                            <t t-else="">
                                <a href="javascript:;" class="document_modify_wraper">文件修改
                                <input type="file" class="document_modify"/>
                                </a>
                            </t>
                        </t>
                    </t>
                    <t t-if="item_files.is_able_to_use == true || approval_type=='waiting_submit' ||approval_type=='waiting_approval'">
                        <t t-if="item_files.is_show_outage == true ">
                            <button class="btn btn-primary document_download" t-att-data="item_files.type">下载</button>
                        </t>
                    </t>


                    <a t-attf-href="/selectfile/file_show?id=#{item_files.id}&amp;type=#{item_files.type}"
                                               target="_blank"> <button class="btn btn-primary get_version_history">查看历史版本</button></a>
                    <t t-if="item_files.has_right_to_review == true || item_files.is_first_review == true">
                        <t t-if="item_files.is_delect_view =='yes'">
                            <div class="delect_one_document" style="padding-top: 6px;">
                                <button class="btn btn-primary delect_document_checked">删除</button>
                            </div>
                        </t>
                    </t>

                   <t t-if="item_files.state[0] == 'released' ">

                        <div class="stop_one_document" style="padding-top: 6px;">
                             <t t-if="item_files.is_show_outage == true ">
                                 <button class="btn btn-primary outage_document_file off" data="off">停用</button>
                                 <span style="color:red;">使用中</span>
                             </t>
                            <t t-if="item_files.is_show_outage == false ">
                                <button class="btn btn-primary outage_document_file on" data="on">启用</button>
                                <span style="color:red;">已停用</span>
                             </t>
                        </div>
                    </t>

                </div>
            </div>
        </t>
    </t>
</templates>