<openerp>
    <data>

        <record id="web_bolog_view_blog_blog_list" model="ir.ui.view">
            <field name="name">blog.blog.list</field>
            <field name="model">blog.blog</field>
            <field name="inherit_id" ref="website_blog.view_blog_blog_list"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='name']" position="after">
                    <!--<field name="blog_tag_ids"/>-->

                    <field name="is_all_blog"/>
                </xpath>

            </field>
        </record>


        <record id="web_bolog_view_blog_blog_form" model="ir.ui.view">
            <field name="name">blog.blog.form</field>
            <field name="model">blog.blog</field>
            <field name="inherit_id" ref="website_blog.view_blog_blog_form"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='name']" position="attributes">
                    <attribute name="string">一级分类</attribute>
                </xpath>

                <xpath expr="//field[@name='name']" position="after">
                    <field name="blog_tag_ids" widget="many2many_tags" string="二级分类"/>

                    <field name="is_all_blog"/>
                </xpath>

            </field>
        </record>


        <record id="website_blog.blog_tag_form" model="ir.ui.view">
            <field name="name">blog_tag_form</field>
            <field name="model">blog.tag</field>
            <field name="arch" type="xml">
                <form string="Tag Form">
                    <sheet>
                        <group>
                            <field name="name"/>
                        </group>
                        <group>
                            <field name="tag_parent_id"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>


        <!-- page list view  -->
        <record id="website_blog.view_blog_post_list" model="ir.ui.view">
            <field name="name">blog.post.list</field>
            <field name="model">blog.post</field>
            <field name="arch" type="xml">
                <tree string="Blog Posts" create="false">
                    <field name="name"/>
                    <field name="active" invisible="1"/>
                    <field name="blog_id"/>
                    <field name="tag_ids"/>
                    <field name="visits"/>
                    <field name="create_uid" invisible="1"/>
                    <field name="write_uid" invisible="1"/>
                    <field name="write_date"/>
                    <field name="website_published"/>
                </tree>
            </field>
        </record>

        <!-- page form view  -->
        <record id="website_blog.view_blog_post_form" model="ir.ui.view">
            <field name="name">blog.post.form</field>
            <field name="model">blog.post</field>
            <field name="arch" type="xml">
                <form string="Blog Post" create="false">
                    <sheet>

                        <div class="oe_button_box" name="button_box">
                            <button name="toggle_active" type="object" class="oe_stat_button" icon="fa-archive">
                                <field name="active" widget="boolean_button" options='{"terminology": "archive"}'/>
                            </button>


                            <!--<button class="oe_stat_button" name="website_publish_button"-->
                            <!--type="object" icon="fa-globe">-->
                            <!--<field name="website_published" widget="website_button"/>-->
                            <!--</button>-->
                            <div groups="website.group_website_publisher">
                                <button class="oe_stat_button" name="website_publish_button_new"
                                        type="object" icon="fa-globe">
                                    <field name="website_published" widget="website_button"/>
                                </button>
                            </div>

                        </div>

                        <group>
                            <field name="blog_id"/>
                            <field name="tag_ids"/>

                            <field name="name" placeholder="Blog Post Title" string="主题"/>
                            <field name="subtitle" placeholder="Blog Subtitle"/>
                            <field name="where_is_look" string="谁可以看到权限设置完毕"/>

                            <label attrs="{'invisible':[('where_is_look','=',False)]}" for="where_user_look" string="谁可以看到"/>
                            <div attrs="{'invisible':[('where_is_look','=',False)]}">
                                <field name="where_user_look" widget="many2many_tags" options="{'no_create':True}"
                                       class="oe_inline"/>
                                或者销售团队
                                <field name="where_user_team_look" widget="many2many_tags" options="{'no_create':True}"
                                       class="oe_inline"/>
                            </div>

                            <!--<field name="where_user_look" widget="many2many_tags"/>-->
                            <!--<field name="where_user_team_look" widget="many2many_tags"/>-->

                        </group>
                        <group invisible="1">
                            <!--<field name="blog_post_type_ids" placeholder="文章分类"/>-->
                        </group>


                        <field name="content" widget="html" options="{'style-inline': true}"/>


                        <script language="javascript">
                            var _check = setTimeout("t()",500);

                            function t(){

                            var ofrm = document.getElementsByClassName("o_readonly")[0].contentWindow.document;
                            if (ofrm!=undefined)
                            {
                            $('.o_readonly').height(document.getElementsByClassName("o_readonly")[0].contentWindow.document.body.scrollHeight);
                            clearInterval(_check);
                            }
                            }

                        </script>


                        <group string="Publishing Options" invisible="1">
                            <field name="author_id" invisible="1"/>
                            <field name="create_date" invisible="1"/>
                            <field name="post_date" invisible="1"/>
                            <field name="write_uid" invisible="1"/>
                            <field name="write_date" invisible="1"/>
                        </group>
                        <group string="Technical" groups="base.group_no_one" invisible="1">
                            <field name="ranking" invisible="1"/>
                        </group>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids" widget="mail_followers" groups="base.group_user"/>
                        <field name="message_ids" widget="mail_thread" options='{"thread_level": 1}'/>
                    </div>

                </form>

            </field>
        </record>
        <!-- page search view  -->
        <record id="website_blog.view_blog_post_search" model="ir.ui.view">
            <field name="name">blog.post.search</field>
            <field name="model">blog.post</field>
            <field name="arch" type="xml">
                <search string="Blog Post">
                    <!--<act_window-->

                    <filter string="已发布" name="is_published" domain="[('website_published', '=', True)]"/>
                    <filter string="未发布" name="not_published" domain="[('website_published', '=',False)]"/>
                    <filter string="Archived" name="inactive" domain="[('active','=',False)]"/>
                    <!--<filter name="name" string="Content"-->
                    <!--filter_domain="['|', ('name','ilike',self), ('content','ilike',self)]"/>-->

                    <group expand="0" string="Group By">
                        <filter string="文章分类" name="group_type" domain="[]" context="{'group_by': 'blog_id'}"/>
                        <filter string="文章标签" name="group_tag" domain="[]" context="{'group_by': 'tag_ids'}"/>

                        <filter string="Author" domain="[]" context="{'group_by': 'create_uid'}"/>

                        <!--<filter string="Last Contributor" domain="[]" context="{'group_by': 'write_uid'}"/>-->
                    </group>
                </search>
            </field>
        </record>


        <!-- page action -->
        <record id="website_blog.action_blog_post" model="ir.actions.act_window">
            <field name="name">Blog Posts</field>
            <field name="res_model">blog.post</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="website_blog.view_blog_post_list"/>
            <field name="search_view_id" ref="website_blog.view_blog_post_search"/>
            <field name="context">{
                'search_default_group_type': 1,
                'search_default_group_tag': 1,
                }
            </field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a new blog post.
                </p>
            </field>
        </record>


        <!-- page action -->
        <record id="blog_post_action" model="ir.actions.act_window">
            <field name="name">我的文章</field>
            <field name="res_model">blog.post</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="website_blog.view_blog_post_list"/>
            <field name="search_view_id" ref="website_blog.view_blog_post_search"/>
            <field name="domain">[('create_uid','=',uid)]</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a new blog post.
                </p>
            </field>
        </record>


        <record id="web_blog_temporary_form" model="ir.ui.view">
            <field name="name">web.blog.temporary.form</field>
            <field name="model">web.blog.temporary</field>
            <field name="arch" type="xml">
                <form string="确认">

                    <p>确认要发布吗?</p>
                    <field name="post_type" widget="radio"/>

                    <footer>
                        <button string="确定" name="set_web_blog_published" type="object" default_focus="1"
                                class="btn-primary"/>
                        <button string="取消" class="btn-default" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <act_window name="批量发布文章"
                    res_model="web.blog.temporary" src_model="blog.post"
                    id="web_blog_batch_post"
                    multi="True"
                    view_mode="form" target="new" view_type="form"
                    groups="website.group_website_publisher"

        />


        <menuitem id="menu_blog_my_blog" parent="website_blog.menu_website_blog_root" name="我的文章"
                  action="blog_post_action" sequence="9"/>

        <!--<menuitem id="website_blog.menu_blog" parent="website_blog.menu_website_blog_root" name="Blogs"-->
        <!--action="website_blog.action_blog_blog" sequence="20"/>-->


    </data>
</openerp>