<odoo>
    <data>


        <record id="output_material_form" model="ir.ui.view">
            <field name="name">产出</field>
            <field name="model">mrp.production</field>
            <field name="priority" eval="100"/>
            <field name="arch" type="xml">
                <form string="产出">
                    <field name="output_product_ids" options="{'reload_on_button': True}">
                        <tree editable="bottom">
                            <field name="product_id" readonly="1" options="{'no_create': True}"/>
                            <!--<field name="total_produce_qty"/>-->
                            <field name="produce_qty"/>
                        </tree>
                    </field>

                    <footer>
                        <button name="confirm_output" string="确认"
                                colspan="1" type="object" class="btn-primary"/>
                        <button string="取消" class="btn-default" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <!--<record id="add_input_output_material_form" model="ir.ui.view">-->
        <!--<field name="name">添加材料</field>-->
        <!--<field name="model">mrp.production</field>-->
        <!--<field name="priority" eval="100"/>-->
        <!--<field name="arch" type="xml">-->
        <!--<form string="Picking material detail">-->
        <!--<sheet>-->
        <!--<notebook>-->
        <!--<page string="投入">-->
        <!--<field name="input_product_ids" options="{'reload_on_button': True}"-->
        <!--context="{'default_type':'input'}">-->
        <!--<tree editable="bottom" delete="1"-->
        <!--create="1">-->

        <!--<field name="product_id" readonly="0" options="{'no_create': True}"/>-->
        <!--<field name="type" invisible="0"/>-->

        <!--&lt;!&ndash;<field name="return_qty"  invisible="[('production_state', 'not in', ('waiting_inventory_material','waiting_warehouse_inspection'))]" string="退料数量"/>&ndash;&gt;-->
        <!--</tree>-->
        <!--</field>-->

        <!--</page>-->

        <!--</notebook>-->
        <!--<notebook>-->
        <!--<page string="产出">-->
        <!--<field name="output_product_ids" options="{'reload_on_button': True}"-->
        <!--context="{'default_type':'output'}" string="产出">-->
        <!--<tree editable="bottom" delete="1" create="1">-->

        <!--<field name="product_id" options="{'no_create': True}"/>-->
        <!--<field name="type" invisible="1"/>-->

        <!--&lt;!&ndash;<field name="return_qty"  invisible="[('production_state', 'not in', ('waiting_inventory_material','waiting_warehouse_inspection'))]" string="退料数量"/>&ndash;&gt;-->
        <!--</tree>-->
        <!--</field>-->
        <!--</page>-->
        <!--</notebook>-->

        <!--</sheet>-->


        <!--<footer>-->
        <!--<button name="picking_material" string="Confirm"-->
        <!--colspan="1" type="object" class="btn-primary"/>-->
        <!--<button string="Cancel" class="btn-default" special="cancel"/>-->
        <!--</footer>-->
        <!--</form>-->
        <!--</field>-->

        <!--</record>-->
        <record id="picking_material_form" model="ir.ui.view">
            <field name="name">Picking Material Detail</field>
            <field name="model">mrp.production</field>
            <field name="priority" eval="100"/>
            <field name="arch" type="xml">
                <form string="Picking material detail">
                    <field name="sim_stock_move_lines" options="{'reload_on_button': True}">
                        <tree editable="bottom" delete="0" decoration-warning="quantity_ready&gt;product_uom_qty"
                              decoration-success="quantity_ready>=product_uom_qty" create="0">
                            <field name="production_state" readonly="1" invisible="1" autofocus="autofocus"/>
                            <field name="product_id" readonly="1" options="{'no_create': True}"/>
                            <field name="qty_available" string="库存"/>
                            <field name="virtual_available" string="预测数量" invisible="1"/>
                            <field name="suggest_qty" readonly="1" string="建议数量" invisible="1"/>
                            <field name="quantity_available" string="系统可用" invisible="1"/>
                            <field name="product_uom_qty" string="实际需求物料数量" invisible="1"/>
                            <field name="quantity_ready" readonly="context.get('quantity_ready_invisible')"
                                   string="备料数量"/>
                            <field name="over_picking_qty" invisible="context.get('overpicking_invisible')"
                                   string="超领数量"/>
                            <!--<field name="return_qty"  invisible="[('production_state', 'not in', ('waiting_inventory_material','waiting_warehouse_inspection'))]" string="退料数量"/>-->
                        </tree>
                    </field>

                    <footer>
                        <button name="picking_material" string="确定"
                                colspan="1" type="object" class="btn-primary"/>
                        <button string="取消" class="btn-default" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>

        <record id="mrp_production_form_view_inherit" model="ir.ui.view">
            <field name="name">mrp.production.tree.inherit</field>
            <field name="model">mrp.production</field>
            <field name="inherit_id" ref="mrp.mrp_production_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='product_uom_id']" position="replace">
                    <field name="product_uom_id" options="{'no_open':True,'no_create':True}" groups="product.group_uom"
                           attrs="{'readonly': [('has_moves', '=', True)],'required':[('is_multi_output','!=',True)],'invisible':[('is_multi_output','=',True)]}"/>

                </xpath>
                <xpath expr="//field[@name='product_id']" position="attributes">
                    <attribute name="attrs">
                        {'invisible':[('is_multi_output','=',True)],
                        'readonly':[('state','not in',['draft','confirmed'])]}
                    </attribute>

                </xpath>

                <xpath expr="//label[@for='product_qty']" position="attributes">

                    <attribute name="attrs">{'invisible':[('is_multi_output','=',True)]}</attribute>
                </xpath>


                <xpath expr="//field[@name='product_qty']" position="attributes">
                    <attribute name="attrs">
                        {'readonly':[('state','not in',['draft','confirmed'])],
                        'invisible':[('is_multi_output','=',True)]}
                    </attribute>


                </xpath>
                <xpath expr="//field[@name='unit_price']" position="attributes">
                    <attribute name="attrs">{'invisible':[('is_multi_output','=',True)]}</attribute>

                </xpath>
                <xpath expr="//field[@name='mo_type']" position="attributes">
                    <attribute name="attrs">{'invisible':[('is_multi_output','=',True)]}</attribute>

                </xpath>
                <xpath expr="//field[@name='hour_price']" position="attributes">
                    <attribute name="attrs">{'invisible':[('is_multi_output','=',True)]}</attribute>
                </xpath>

                <xpath expr="//field[@name='product_id']" position="after">
                    <field name="rule_id" options="{'no_create':True}" string="规则"
                           attrs="{'required':[('is_multi_output','=',True)],'invisible':[('is_multi_output','!=',True)]}"/>
                </xpath>


                <xpath expr="//field[@name='bom_id']" position="attributes">
                    <attribute name="required">0</attribute>
                    <attribute name="attrs">{'invisible':[('is_multi_output','=',True)]}</attribute>
                </xpath>

                <xpath expr="//button[@name='open_produce_product']" position="replace">

                    <!--<button name="add_input_out_products" class="oe_highlight"-->
                    <!--attrs="{'invisible': [('state', '!=', 'draft')]}" type="object"-->
                    <!--string="添加投入产出" groups="linkloving_mrp_extend.group_charge_inspection"/>-->
                    <button name="button_multi_output" class="oe_highlight"
                            attrs="{'invisible': [('state', '!=', 'progress')]}" type="object"
                            string="产出" groups="linkloving_mrp_extend.group_charge_inspection"/>

                </xpath>


                <xpath expr="//field[@name='bom_id']" position="after">
                    <field name="is_multi_output" invisible="1"/>
                    <field name="is_force_output"
                           attrs="{'readonly':[('state','not in',['draft','confirmed'])],'invisible':[('is_multi_output','!=',True)]}"/>
                </xpath>


                <xpath expr="//notebook/page[3]" position="replace">
                </xpath>
                <xpath expr="//notebook/page[2]" position="replace">
                    <page string="投入" attrs="{'invisible':[('state','not in',['draft','confirmed'])]}">
                        <field name="input_product_ids" readonly="1">
                            <tree editable="bottom" create="0" delete="0">
                                <field name="product_id" options="{'no_create':True}" string="产品"/>
                                <field name="type" invisible="1"/>
                            </tree>
                        </field>
                    </page>
                    <page string="产出" attrs="{'invisible':[('state','not in',['draft','confirmed'])]}">
                        <field name="output_product_ids" readonly="1" create="0">
                            <tree editable="bottom" create="0" delete="0">
                                <field name="product_id" options="{'no_create':True}" string="产品"/>
                                <field name="type" invisible="1"/>
                            </tree>
                        </field>
                    </page>


                    <page string="投入1"
                          attrs="{'invisible':[('state','in',['draft','confirmed']),('is_multi_output','=',True)]}">
                        <field name="sim_stock_move_lines"
                               attrs="{'invisible':[('state','in',['draft','confirmed'])]}">
                            <tree editable="bottom" delete="0" decoration-warning="quantity_done&gt;product_uom_qty"
                                  decoration-success="quantity_done>=product_uom_qty"
                                  decoration-danger="qty_available&lt;product_uom_qty" create="0">
                                <field name="product_id" string="产品" options="{'no_create':True}"/>
                                <field name="qty_available" string="库存"/>
                                <field name="virtual_available" string="预测数量" invisible="1"/>
                                <field name="suggest_qty" string="建议数量" invisible="1"/>
                                <field name="quantity_available" string="系统可用" invisible="1"/>
                                <field name="product_uom_qty" string="需求数量" invisible="1"/>
                                <field name="quantity_done" string="备料数量"/>
                                <field name="return_qty" readonly="1" string="退料数量"/>
                            </tree>
                        </field>

                    </page>
                    <page string="产出1" attrs="{'invisible':[('state','in',['draft','confirmed'])]}">
                        <field name="stock_move_lines_finished" readonly="1" context="{'default_type':'output'}"
                               create="0">
                            <tree editable="bottom" create="0" delete="0">
                                <field name="product_id" options="{'no_create':True}" string="产品"/>
                                <field name="quantity_done_finished" string="产出数量"/>
                            </tree>
                        </field>
                    </page>
                </xpath>
            </field>
        </record>
    </data>
</odoo>