<openerp>
    <data>
        <record id="linkloving_view_users_form_simple_modif_mail" model="ir.ui.view">
            <field name="name">res.users.preferences.form.mail</field>
            <field name="model">res.users</field>
            <field name="inherit_id" ref="base.view_users_form_simple_modif"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='email']" position="replace">
                    <field name="email" string="邮箱地址" readonly="0"/>
                    <field name="mail_server" string="配置邮箱服务" context="{'default_name':email}" readonly="0"/>
                </xpath>
                <!--<data>-->
                <!--<field name="email" position="replace"/>-->
                <!--<field name="signature" position="before">-->
                <!--<group>-->
                <!--<field name="email"/>-->
                <!--<field name="mail_server" context="{'default_name':email}" options="{'no_open':True}"/>-->
                <!--</group>-->
                <!--</field>-->
                <!--</data>-->
            </field>
        </record>

        <record id="menu_sales_email_send_action" model="ir.actions.act_window">
            <field name="name">发件箱</field>
            <field name="res_model">mail.mail</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('create_uid', '=', uid)]</field>
            <field name="context">
                {
                'search_default_sent': 1,
                }
            </field>
            <field name="search_view_id" ref="mail.view_mail_search"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to add a Email.
                </p>
            </field>
        </record>

        <record id="view_load_subscribe_search" model="ir.ui.view">
            <field name="name">email.send.statistics .search</field>
            <field name="model">email.send.statistics</field>
            <field name="arch" type="xml">
                <search string="Blog Post">

                    <filter string="已退订" name="unsubcribed"
                            domain="[('request_type', '=', 'subscribe'),('is_subscribe', '=', 'True')]"/>

                    <group expand="0" string="Group By">
                        <filter string="邮件标题分类" name="title_group_type" domain="[]" context="{'group_by': 'name'}"/>
                    </group>
                </search>
            </field>
        </record>


        <record id="menu_sales_email_load_subscribe_action" model="ir.actions.act_window">
            <field name="name">邮件统计</field>
            <field name="res_model">email.send.statistics</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="search_view_id" ref="view_load_subscribe_search"/>
            <field name="domain">[]</field>
            <field name="context">
                {
                }
            </field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    邮件统计详情
                </p>
            </field>
        </record>


        <!--email.send.statistics-->
        <record model="ir.ui.view" id="view_load_subscribe_form">
            <field name="name">email.send.statistics .form</field>
            <field name="model">email.send.statistics</field>
            <field name="arch" type="xml">
                <form create="1" delete="1">
                    <sheet>
                        <group>

                            <field name="name"/>
                            <field name="request_type"/>
                            <field name="is_subscribe" attrs="{'invisible': [('request_type','=','read')]}"/>
                            <field name="email"/>

                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="view_load_subscribe_tree" model="ir.ui.view">
            <field name="name">email.send.statistics .tree</field>
            <field name="model">email.send.statistics</field>
            <field name="arch" type="xml">
                <tree create="1">
                    <field name="name"/>
                    <field name="email"/>
                    <field name="request_type"/>
                    <field name="is_subscribe"/>

                </tree>
            </field>
        </record>


        <record id="menu_sales_email_inbox_action" model="ir.actions.act_window">
            <field name="name">收件箱</field>
            <field name="res_model">mail.mail</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="domain">[('state','=','received'),('create_uid', '=', uid)]</field>
            <field name="context">
                {
                }
            </field>
            <field name="search_view_id" ref="mail.view_mail_search"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to add a Email.
                </p>
            </field>
        </record>


        <menuitem id="menu_sales_email" name="邮件销售" sequence="4"/>


        <menuitem action="menu_sales_email_inbox_action"
                  id="menu_sales_email_inbox"
                  parent="menu_sales_email"
                  groups=""
                  sequence="1" name="收件箱"/>


        <menuitem action="menu_sales_email_send_action"
                  id="menu_sales_email_send"
                  parent="menu_sales_email"
                  groups=""
                  sequence="2" name="发件箱"/>

        <menuitem action="menu_sales_email_load_subscribe_action"
                  id="menu_sales_email_load_subscribe"
                  parent="menu_sales_email"
                  groups=""
                  sequence="3" name="邮件退订与查看率"/>


        <!--<menuitem id="linkloving_auto_smtp_menu_mail_message"-->
                  <!--parent="menu_sales_email"-->
                  <!--name="Messages"-->
                  <!--action="mail.action_view_mail_message"/>-->


        <!--<menuitem action="menu_sales_email_send_action"-->
        <!--id="menu_sales_email_draft"-->
        <!--parent="menu_sales_email"-->
        <!--groups=""-->
        <!--sequence="3" name="草稿"/>-->

        <record id="linkloving_auto_smtp_view_mail_form" model="ir.ui.view">
            <field name="name">mail.mail.form</field>
            <field name="model">mail.mail</field>
            <field name="inherit_id" ref="mail.view_mail_form"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='recipient_ids']" position="replace">
                </xpath>

                <xpath expr="//field[@name='email_cc']" position="after">
                    <field name="char_filter" placeholder="多个以逗号 隔开"/>
                </xpath>

                <xpath expr="//field[@name='reply_to']" position="attributes">
                    <attribute name='invisible'>1</attribute>
                </xpath>

                <xpath expr="//field[@name='scheduled_date']" position="attributes">
                    <attribute name='invisible'>1</attribute>
                </xpath>

                <xpath expr="//notebook/page[2]" position="attributes">
                    <attribute name='invisible'>1</attribute>
                </xpath>

                <xpath expr="//notebook/page[3]" position="after">

                    <page string="发送至客户">
                        <field name="recipient_ids" widget="many2many_kanban" options="{'not_delete': True}"
                               context="{'default_customer':True,'default_is_company':True}"
                               domain="[('customer','=','1'),('is_company','=',True)]">
                            <kanban quick_create="false" create="true" delete="true">
                                <field name="name"/>
                                <templates>
                                    <t t-name="kanban-box">
                                        <div class="oe_kanban_global_click" style="position: relative">
                                            <a t-if="! read_only_mode" type="delete"
                                               style="position: absolute; right: 0; padding: 4px; diplay: inline-block">
                                                X
                                            </a>
                                            <div class="oe_module_vignette">
                                                <img t-att-src="kanban_image('res.users', 'image_small', record.id.value)"
                                                     class="oe_avatar oe_kanban_avatar_smallbox"/>
                                                <div class="oe_module_desc">
                                                    <field name="name"/>
                                                </div>
                                            </div>
                                        </div>
                                    </t>
                                </templates>
                            </kanban>
                        </field>
                    </page>

                </xpath>

                <xpath expr="//notebook/page[1]" position="replace">
                    <page string="正文">
                        <field name="body_html" class="email_this_body_html" widget="html"
                               options="{'style-inline': true}"/>
                    </page>
                </xpath>

            </field>
        </record>


        <record id="linkloving_auto_smtp_email_compose_message_wizard_form" model="ir.ui.view">
            <field name="name">mail.compose.message.form</field>
            <field name="model">mail.compose.message</field>
            <field name="groups_id" eval="[(4,ref('base.group_user'))]"/>
            <field name="inherit_id" ref="mail.email_compose_message_wizard_form"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='partner_ids']" position="replace">
                    <field name="partner_ids" widget="many2many_tags" placeholder="Add contacts to notify..."
                           context="{'force_email':True, 'show_email':True}"
                           attrs="{'invisible': [('composition_mode', '!=', 'comment')]}"/>
                </xpath>

            </field>
        </record>


        <!--<record id="linkloving_auto_smtp_view_mail_form" model="ir.ui.view">-->
        <!--<field name="name">mail.mail.form</field>-->
        <!--<field name="model">mail.mail</field>-->
        <!--<field name="inherit_id" ref="mail.view_mail_form"/>-->
        <!--<field name="arch" type="xml">-->


        <!---->

        <!--</field>-->
        <!--</record>-->

        <record model="ir.actions.act_window" id="base.action_ir_mail_server_list">
            <field name="name">Outgoing Mail Servers</field>
            <field name="res_model">ir.mail_server</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="view_id" ref="base.ir_mail_server_list"/>
            <field name="search_view_id" ref="base.view_ir_mail_server_search"/>
        </record>


    </data>
</openerp>