<openerp>
    <data>
        <!--  confirm production model  -->
        <record id="action_confirm_production" model="ir.actions.act_window">
            <field name="name">Confirm Production</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">confirm.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">form</field>
            <field name="target">new</field>
        </record>

        <record id="view_confirm_production_wizard" model="ir.ui.view">
            <field name="name">Confirm Production</field>
            <field name="model">confirm.production</field>
            <field name="arch" type="xml">
                <form string="Confirm Production">
                    <group>
                        <field name="product_qty"/>
                    </group>
                    <footer>
                        <button name="confirm_production" string="Confirm"
                                colspan="1" type="object" class="btn-primary"/>
                        <button string="Cancel" class="btn-default" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>
        <record id="linkloving_mrp_bom_tree_view" model="ir.ui.view">
            <field name="name">mrp.bom.tree.inherit</field>
            <field name="model">mrp.bom</field>
            <field name="inherit_id" ref="mrp.mrp_bom_tree_view"/>
            <field name="arch" type="xml">
                <xpath expr="//tree/field[@name='product_tmpl_id']" position="after">
                    <field name="product_specs"/>
                </xpath>
            </field>
        </record>


        <record id="view_mrp_bom_filter_ol" model="ir.ui.view">
            <field name="name">mrp.bom.filter.inherit</field>
            <field name="model">mrp.bom</field>
            <field name="inherit_id" ref="mrp.view_mrp_bom_filter"/>
            <field name="arch" type="xml">
                <xpath expr="//filter[@name='normal']" position="after">
                    <filter name='draft' string="草稿BOM" domain="[('state', '=', 'draft')]"/>
                    <filter name='release' string="正式BOM" domain="[('state', '=', 'release')]"/>
                </xpath>


            </field>
        </record>

        <record id="linkloving_mrp_bom_form_view" model="ir.ui.view">
            <field name="name">mrp.bom.form.inherit</field>
            <field name="model">mrp.bom</field>
            <field name="inherit_id" ref="mrp.mrp_bom_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//tree" position="attributes">
                    <attribute name="decoration-danger">active1==False</attribute>
                </xpath>
                <xpath expr="//field[@name='bom_line_ids']/tree/field[@name='product_id']" position="after">
                    <button name="show_product_form" type="object" string="产品"/>
                    <field name="product_specs"/>
                    <field name="scrap_rate"/>
                    <field name="active1" invisible="1"/>
                    <button name="action_see_bom_structure_reverse" type="object" string="Bom逆展"/>
                </xpath>

                <xpath expr="//sheet" position="before">
                    <header>
                        <button name="set_to_release" type="object" states="draft" string="确认"
                                class="oe_highlight"/>
                        <field name="state" widget="statusbar" readonly="1"/>
                    </header>
                </xpath>


            </field>
        </record>

        <record id="linkloving_mrp_production_form_view" model="ir.ui.view">
            <field name="name">mrp.production.tree.inherit</field>
            <field name="model">mrp.production</field>
            <field name="inherit_id" ref="mrp.mrp_production_form_view"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='product_id']" position="attributes">
                    <attribute name="options">{'no_create':True}</attribute>
                </xpath>
                <xpath expr="//field[@name='bom_id']" position="attributes">
                    <attribute name="options">{'no_create':True}</attribute>
                </xpath>

                <xpath expr="//button[@name='button_plan']" position="after">
                    <button name="button_action_confirm_draft" class="oe_highlight"
                            attrs="{'invisible': [('state', 'not in', 'draft')]}" type="object"
                            groups="linkloving_mrp_extend.group_charge_produce" string="Confirm the Schedule"/>
                    <button name="button_waiting_material" class="oe_highlight"
                            attrs="{'invisible': [('state', 'not in', 'confirmed')]}" type="object"
                            groups="linkloving_mrp_extend.group_charge_produce"
                            string="Confirm Order,Prepare Material"/>
                    <button name="button_start_prepare_material" class="oe_highlight"
                            attrs="{'invisible': [('state', 'not in', 'waiting_material')]}" type="object"
                            string="Start Prepare Material" groups="linkloving_mrp_extend.group_charge_warehouse"/>
                    <button name="button_finish_prepare_material" class="oe_highlight"
                            attrs="{'invisible': [('state', 'not in', 'prepare_material_ing')]}" type="object"
                            string="Material Ready" groups="linkloving_mrp_extend.group_charge_warehouse"/>
                    <!--<button name="button_already_picking" class="oe_highlight" attrs="{'invisible': [('state', '!=', 'finish_prepare_material')]}" type="object" string="已领料" />-->
                    <button name="button_already_picking" class="oe_highlight"
                            attrs="{'invisible': [('state', '!=', 'finish_prepare_material')]}" type="object"
                            string="Receive Material Register" groups="linkloving_mrp_extend.group_charge_produce"/>
                    <button name="button_start_produce" class="oe_highlight"
                            attrs="{'invisible': ['|',('state', '!=', 'already_picking'),('is_outside', '=', True)]}"
                            type="object" string="开始生产"
                            groups="linkloving_mrp_extend.group_charge_produce"/>
                    <button name="button_send_material_to_vendor" class="oe_highlight"
                            attrs="{'invisible': ['|',('state', '!=', 'already_picking'),('is_outside', '=', False)]}"
                            type="object" string="发料至供应商"
                            groups="linkloving_mrp_extend.group_charge_produce"/>
                    <button name="button_produce_finish" class="oe_highlight"
                            attrs="{'invisible': [ '|', ('availability', 'not in', ['partially_available', 'assigned']),('state', '!=', 'progress')]}"
                            type="object" string="Production Complete,Send to Inspection"
                            groups="linkloving_mrp_extend.group_charge_produce"/>
                    <button name="button_start_quality_inspection" class="oe_highlight"
                            attrs="{'invisible': [('state', '!=', 'waiting_quality_inspection')]}" type="object"
                            string="Start Inspection" groups="linkloving_mrp_extend.group_charge_inspection"/>

                    <button name="button_quality_inspection_success"
                            attrs="{'invisible': [('state', '!=', 'quality_inspection_ing')]}" type="object"
                            string="Quality Inspection Pass" groups="linkloving_mrp_extend.group_charge_inspection"/>
                    <button name="button_quality_inspection_failed"
                            attrs="{'invisible': [('state', '!=', 'quality_inspection_ing')]}" type="object"
                            string="Quality Inspection Fail" groups="linkloving_mrp_extend.group_charge_inspection"/>

                    <button name="button_inventory_material"
                            attrs="{'invisible': [('state', 'not in', ('waiting_inventory_material'))]}" type="object"
                            string="Count Material" groups="linkloving_mrp_extend.group_charge_produce"/>
                    <button name="button_check_inventory_material" context="{'is_checking':True}"
                            attrs="{'invisible': [('state', 'not in', ('waiting_warehouse_inspection'))]}" type="object"
                            string="Warehouse Confirm Material" groups="linkloving_mrp_extend.group_charge_warehouse"/>

                    <button name="button_fill_material" attrs="{'invisible': ['|',('state', '!=', 'progress')]}"
                            type="object" string="Extra Picking Material"
                            groups="linkloving_mrp_extend.group_charge_produce"/>
                    <!--<button name="button_return_material" attrs="{'invisible': ['|',('state', '!=', 'done')]}"-->
                    <!--type="object" string="Return Material"/>-->
                </xpath>

                <xpath expr="//header/button[@name='button_scrap']" position="replace">
                    <button name="button_scrap" type="object" string="Scrap" attrs="{'invisible': True}"/>
                </xpath>

                <xpath expr="//header/button[@name='action_cancel']" position="replace">
                    <button name="action_cancel" type="object" string="Cancel"
                            attrs="{'invisible': [('state', 'not in', ('confirmed','waiting_material', 'prepare_material_ing'))]}"
                            groups="linkloving_mrp_extend.group_charge_produce"/>
                </xpath>

                <xpath expr="//header/button[@name='button_unreserve']" position="replace">
                </xpath>

                <xpath expr="//header/button[@name='open_produce_product'][2]" position="replace">
                </xpath>

                <xpath expr="//header/button[@name='open_produce_product'][1]" position="replace">
                    <button name="open_produce_product"
                            attrs="{'invisible': ['|', '|', '|', ('check_to_done', '=', True), ('availability', 'not in', ['partially_available', 'assigned']), ('state', 'not in', ('progress')), ('routing_id', '!=', False)]}"
                            string="产出" type="object" class="oe_highlight"
                            groups="linkloving_mrp_extend.group_charge_produce"/>
                </xpath>

                <xpath expr="//sheet/group/group/div/button[@type='action']" position="replace">
                    <button type="action"
                            name="%(mrp.action_change_production_qty)d"
                            string="Update" states="confirmed,planned" class="oe_link"/>
                </xpath>

                <!--添加订单类型-->
                <xpath expr="//field[@name='origin']" position="after">
                    <field name="production_order_type" widget="radio"/>
                </xpath>
                <xpath expr="//group" position="after">
                    <field name="output_rate"/>
                </xpath>

                <xpath expr="//notebook/page[3]" position="after">
                    <page string="Result">
                        <group colspan="4">
                            <group>
                                <label for="total_spent_time"/>
                                <div>
                                    <field name="total_spent_time" widget="float_time"
                                           class="oe_inline"/> <!--widget="float_time" class="inline"-->
                                    Mins
                                </div>
                                <field name="total_spent_money"/>

                            </group>
                            <field name="worker_line_ids" readonly="1">
                                <tree>
                                    <field name="worker_id"/>
                                    <field name="line_state"/>

                                    <!--<label for="spent_time"/>-->
                                    <!--<div>-->
                                    <field name="spent_time" string="Time Taken" widget="float_time" class="oe_inline"/>
                                    <!--分钟-->
                                    <!--</div>-->
                                </tree>
                                <form>
                                    <group>
                                        <field name="worker_id"/>
                                        <field name="mo_type"/>
                                        <field name="spent_time" widget="float_time"/>
                                        <field name="worker_time_line_ids" string="Time Taken Detail">
                                            <tree>
                                                <field name="start_time"/>
                                                <field name="end_time"/>
                                                <field name="state"/>
                                            </tree>
                                        </field>
                                    </group>
                                </form>
                            </field>

                        </group>

                    </page>
                </xpath>

                <xpath expr="//field[@name='move_finished_ids']/tree/field[@name='product_id']" position="attributes">
                    <attribute name="options">{'no_create':True}</attribute>
                </xpath>


                <xpath expr="//field[@name='move_raw_ids']" position="replace">
                    <field name="sim_stock_move_lines">
                        <tree editable="bottom" delete="0" decoration-warning="quantity_done&gt;product_uom_qty"
                              decoration-success="quantity_done>=product_uom_qty"
                              decoration-danger="qty_available&lt;product_uom_qty" create="0">
                            <field name="product_id" string="产品" options="{'no_create':True}"/>
                            <field name="qty_available" string="库存"/>
                            <field name="virtual_available" string="Forecast Quantity"/>
                            <field name="suggest_qty" string="Suggest Quantity"/>
                            <field name="quantity_available" string="系统可用"/>
                            <field name="product_uom_qty" string="Demand Quantity"/>
                            <field name="quantity_done" string="备料数量"/>
                            <field name="return_qty" readonly="1" string="Return Quantity"/>
                        </tree>
                    </field>
                </xpath>
                <xpath expr="//field[@name='state']" position="replace">
                    <field name="state" widget="statusbar"
                           statusbar_visible="confirmed,waiting_material,prepare_material_ing,finish_prepare_material,already_picking,progress,waiting_quality_inspection,quality_inspection_ing,waiting_post_inventory,done"/>
                </xpath>

                <xpath expr="//button[@name='post_inventory']" position="replace">
                    <!--<button name="post_inventory" string="Post Inventory" type="object" class="oe_highlight" attrs="{'invisible': ['|', ('post_visible', '=', False),('state', 'not in', 'waiting_post_inventory')]}"/>-->
                </xpath>

                <xpath expr="//button[@name='button_mark_done']" position="replace">
                    <button name="button_mark_done"
                            string="标记为完成"
                            attrs="{'invisible': [ ('state', 'not in', 'waiting_post_inventory')]}" type="object"
                            class="oe_highlight" groups="linkloving_mrp_extend.group_charge_produce"/>
                </xpath>

                <xpath expr="//button[@name='action_assign']" position="replace">
                    <button name="action_assign" string="检查可用性"
                            attrs="{'invisible': ['|',('availability', 'in', ('assigned', 'none')),('state','not in',('progress'))]}"
                            type="object" groups="linkloving_mrp_extend.group_charge_produce"/>
                </xpath>
            </field>
        </record>
        <record id="product_product_action" model="ir.actions.act_window">
            <field name="name">产品变型</field>
            <field name="res_model">product.product</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="context">{}</field>
        </record>

        <record id="product_template_deactive" model="ir.actions.act_window">
            <field name="name">归档的产品</field>
            <field name="res_model">product.template</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form</field>
            <field name="domain">[('active','=',False)]</field>

            <field name="context">{}</field>
        </record>

        <menuitem action="product_template_deactive" id="menu_stock_product_template_deactive_menu"
                  parent="mrp.menu_mrp_bom"
                  string="归档的产品"
                  sequence="10"/>

        <menuitem action="product_product_action" id="menu_stock_product_product_menu" parent="mrp.menu_mrp_bom"
                  groups="base.group_no_one,base.group_system" string="产品变型"
                  sequence="10"/>

        <record id="product_normal_form_view" model="ir.ui.view">
            <field name="name">product.product.inhert</field>
            <field name="model">product.product</field>
            <field name="inherit_id" ref="product.product_normal_form_view"/>

            <field name="arch" type="xml">
                <div name="button_box" position="inside">
                    <button class="oe_stat_button" name="action_see_bom_structure_reverse" type="object"
                            icon="fa-tasks" string="Bom 逆展">
                    </button>
                </div>
            </field>
        </record>

        <record id="mrp.product_template_form_view_bom_button" model="ir.ui.view">
            <field name="name">product.template.procurement</field>
            <field name="model">product.template</field>
            <field name="inherit_id" ref="product.product_template_only_form_view"/>
            <field name="groups_id"
                   eval="[(4, ref('mrp.group_mrp_user')),(4, ref('sales_team.group_sale_salesman')),(4, ref('purchase.group_purchase_user'))]"/>
            <field name="arch" type="xml">
                <div name="button_box" position="inside">
                    <button class="oe_stat_button" name="%(mrp.template_open_bom)d" type="action"
                            attrs="{'invisible':[('type', 'not in', ['product', 'consu'])]}" icon="fa-flask">
                        <field string="Bill of Materials" name="bom_count" widget="statinfo"/>
                    </button>
                    <button class="oe_stat_button" name="action_see_bom_structure_reverse" type="object"
                            icon="fa-tasks" string="Bom 逆展">
                    </button>

                    <button class="oe_stat_button" name="action_view_mos" type="object"
                            attrs="{'invisible':[('type', 'not in', ['product', 'consu'])]}" icon="fa-list-alt">
                        <field string="Manufacturing" name="mo_count" widget="statinfo"/>
                    </button>
                </div>
            </field>
        </record>


        <record id="picking_material_form" model="ir.ui.view">
            <field name="name">Picking Material Detail</field>
            <field name="model">mrp.production</field>
            <field name="priority" eval="100"/>
            <field name="arch" type="xml">
                <form string="Picking material detail">
                    <field name="sim_stock_move_lines" options="{'reload_on_button': True}">
                        <tree editable="bottom" delete="0" decoration-warning="quantity_ready&gt;product_uom_qty"
                              decoration-success="quantity_ready>=product_uom_qty" create="0">
                            <field name="production_state" readonly="1" invisible="1" autofocus="autofocus"/>
                            <field name="product_id" readonly="1" options="{'no_create': True}"/>
                            <field name="qty_available" string="库存"/>
                            <field name="virtual_available" string="预测数量"/>
                            <field name="suggest_qty" readonly="1" string="建议数量"/>
                            <field name="quantity_available" string="系统可用"/>
                            <field name="product_uom_qty" string="实际需求物料数量"/>
                            <field name="quantity_ready" readonly="context.get('quantity_ready_invisible')"
                                   string="备料数量"/>
                            <field name="over_picking_qty" invisible="context.get('overpicking_invisible')"
                                   string="超领数量"/>
                            <!--<field name="return_qty"  invisible="[('production_state', 'not in', ('waiting_inventory_material','waiting_warehouse_inspection'))]" string="退料数量"/>-->
                        </tree>
                    </field>
                    <!--<field name="move_raw_ids" options="{'reload_on_button': True}">-->
                    <!--<tree editable="bottom" delete="0" default_order="is_done desc,sequence" decoration-muted="is_done" decoration-warning="quantity_done&gt;product_uom_qty" decoration-success="quantity_done==product_uom_qty" decoration-danger="quantity_available &lt; product_uom_qty" create="0">-->
                    <!--<field name="product_id" required="1"/>-->
                    <!--<field name="product_uom" groups="product.group_uom"/>-->
                    <!--<field name="has_tracking" invisible="1"/>-->
                    <!--<field name="is_done" invisible="1"/>-->
                    <!--<field name="sequence" invisible="1"/>-->
                    <!--<field name="location_id" domain="[('id', 'child_of', parent.location_id)]" invisible="1"/>-->
                    <!--<field name="location_dest_id" domain="[('id', 'child_of', parent.location_dest_id)]" invisible="1"/>-->
                    <!--<field name="state" invisible="1"/>-->
                    <!--<field name="suggest_qty" readonly="1"/>-->
                    <!--<field name="quantity_available" attrs="{'invisible': [('is_done', '=', True)]}"/>-->
                    <!--<field name="product_uom_qty" readonly="1" attrs="{'required': [('product_id', '!=', False)]}" string="To Consume"/>-->
                    <!--<field name="quantity_done" attrs="{'readonly': [ '|', ('is_done', '=', True),('has_tracking', 'in', ['lot','serial'])]}" string="Consumed"/>-->
                    <!--<field name="over_picking_qty" invisible="context.get('overpicking_invisible')"/>-->
                    <!--<button name="split_move_lot" string="Register lots" type="object" icon="fa-list" attrs="{'invisible': [('has_tracking', 'not in', ['lot','serial'])]}"/>-->
                    <!--</tree>-->
                    <!--</field>-->
                    <footer>
                        <button name="picking_material" string="Confirm"
                                colspan="1" type="object" class="btn-primary"/>
                        <button string="Cancel" class="btn-default" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>


        <record id="stock_return_material_form_view2" model="ir.ui.view">
            <field name="name">mrp.return.material.form</field>
            <field name="model">mrp.return.material</field>
            <field name="arch" type="xml">
                <form string="Return Material">
                    <group>
                        <!--<group>-->
                        <!--&lt;!&ndash;<label for="return_qty"/>&ndash;&gt;-->
                        <!--&lt;!&ndash;<div class="o_row">&ndash;&gt;-->
                        <!--&lt;!&ndash;<field name="return_qty"/>&ndash;&gt;-->
                        <!--&lt;!&ndash;&lt;!&ndash;<field name="product_uom_id" groups="stock.product_group_uom"/>&ndash;&gt;&ndash;&gt;-->
                        <!--&lt;!&ndash;</div>&ndash;&gt;-->
                        <!--</group>-->
                        <field name="state" invisible="1"/>
                        <!--<group>-->
                        <!--&lt;!&ndash;<field name="owner_id" groups="stock.group_tracking_owner"/>&ndash;&gt;-->
                        <!--<field name="product_id" readonly="1"/>-->
                        <!--<field name="product_produced_qty"/>-->
                        <!--</group>-->
                        <group>
                            <field name="location_id" groups="stock.group_stock_multi_locations"/>
                            <field name="return_location_id" groups="stock.group_stock_multi_locations"/>
                        </group>
                    </group>
                    <notebook>
                        <page>
                            <field name="return_ids">
                                <tree editable="bottom" create="false" delete="false">
                                    <field name="product_id" readonly="1"/>
                                    <field name="return_qty"/>
                                </tree>
                            </field>
                        </page>
                    </notebook>
                    <footer>
                        <button name="action_done" string="Done" type="object" class="btn-primary"/>
                        <button string="Cancel" class="btn-default" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>


        <record id="view_mrp_production_filter" model="ir.ui.view">
            <field name="name">mrp.production.select</field>
            <field name="model">mrp.production</field>
            <field name="inherit_id" ref="mrp.view_mrp_production_filter"/>
            <field name="arch" type="xml">
                <xpath expr="//filter[@name='todo']" position="attributes">

                    <attribute name="domain">[('state','not in',['cancel','done'])]</attribute>
                </xpath>
                <xpath expr="//filter[@name='waiting']" position="after">
                    <filter string="Waiting Prepare Material" name="waiting_material"
                            domain="[('state', '=', 'waiting_material')]"/>
                    <filter string="Under Preparing" name="prepare_material_ing"
                            domain="[('state', '=', 'prepare_material_ing')]"/>
                    <filter string="Material Ready" name="finish_prepare_material"
                            domain="[('state', '=', 'finish_prepare_material')]"/>
                    <filter string="Already Picking Material" name="already_picking"
                            domain="[('state', '=', 'already_picking')]"/>
                    <filter string="Waiting Quality Inspection" name="waiting_quality_inspection"
                            domain="[('state', '=', 'waiting_quality_inspection')]"/>
                    <filter string="Under Quality Inspection" name="quality_inspection_ing"
                            domain="[('state', '=', 'quality_inspection_ing')]"/>
                    <filter string="Waiting Transfer In Stock" name="waiting_post_inventory"
                            domain="[('state', '=', 'waiting_post_inventory')]"/>
                </xpath>
            </field>
        </record>


        <record id="mrp_confirmed" model="ir.actions.act_window">
            <field name="name">Confirmed Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'confirmed')]</field>
            <field name="context">{'state':'confirmed'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_confirmed"
                  name="Confirmed Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_confirmed"
                  sequence="21"
                  groups="group_charge_produce"/>

        <record id="mrp_waiting_material" model="ir.actions.act_window">
            <field name="name">Waiting Material Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'waiting_material')]</field>
            <field name="context">{'state':'waiting_material'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_waiting_material"
                  name="Waiting Material Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_waiting_material"
                  sequence="22"
                  groups="group_charge_warehouse"/>

        <record id="mrp_prepare_material_ing" model="ir.actions.act_window">
            <field name="name">Prepare Material ing Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'prepare_material_ing')]</field>
            <field name="context">{'state':'prepare_material_ing'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_prepare_material_ing"
                  name="Prepare Material ing Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_prepare_material_ing"
                  sequence="23"
                  groups="group_charge_warehouse"/>

        <record id="mrp_finish_prepare_material" model="ir.actions.act_window">
            <field name="name">Finish Prepare Material Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'finish_prepare_material')]</field>
            <field name="context">{'state':'finish_prepare_material'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_finish_prepare_material"
                  name="Finish Prepare Material Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_finish_prepare_material"
                  sequence="24"
                  groups="group_charge_produce"/>

        <record id="mrp_already_picking" model="ir.actions.act_window">
            <field name="name">Already Picking Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'already_picking')]</field>
            <field name="context">{'state':'already_picking'}</field>

            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_already_picking"
                  name="Already Picking Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_already_picking"
                  sequence="25"
                  groups="group_charge_produce"/>

        <record id="mrp_progress" model="ir.actions.act_window">
            <field name="name">Progress Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'progress')]</field>
            <field name="context">{'state':'progress'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_progress"
                  name="Progress Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_progress"
                  sequence="26"
                  groups="group_charge_produce"/>

        <record id="mrp_waiting_quality_inspection" model="ir.actions.act_window">
            <field name="name">Waiting Inspection Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'waiting_quality_inspection')]</field>
            <field name="context">{'state':'waiting_quality_inspection'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_waiting_quality_inspection"
                  name="Waiting Inspection Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_waiting_quality_inspection"
                  sequence="27"
                  groups="group_charge_inspection"/>


        <record id="mrp_quality_inspection_ing" model="ir.actions.act_window">
            <field name="name">Inspection ing Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'quality_inspection_ing')]</field>
            <field name="context">{'state':'quality_inspection_ing'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_quality_inspection_ing"
                  name="Inspection ing Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_quality_inspection_ing"
                  sequence="28"
                  groups="group_charge_inspection"/>

        <record id="mrp_waiting_inventory_material" model="ir.actions.act_window">
            <field name="name">Waiting Inventory Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'waiting_inventory_material')]</field>
            <field name="context">{'state':'waiting_inventory_material'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_waiting_inventory_material"
                  name="Waiting Inventory Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_waiting_inventory_material"
                  sequence="29"
                  groups="group_charge_produce"/>

        <record id="mrp_waiting_warehouse_inspection" model="ir.actions.act_window">
            <field name="name">Waiting Warehouse Insepcetion Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'waiting_warehouse_inspection')]</field>
            <field name="context">{'state':'waiting_warehouse_inspection'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_waiting_warehouse_inspection"
                  name="Waiting Warehouse Insepcetion Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_waiting_warehouse_inspection"
                  sequence="30"
                  groups="group_charge_warehouse"/>

        <record id="mrp_waiting_post_inventory" model="ir.actions.act_window">
            <field name="name">Waiting Post Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'waiting_post_inventory')]</field>
            <field name="context">{'state':'waiting_post_inventory'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_waiting_post_inventory"
                  name="Waiting Post Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_waiting_post_inventory"
                  sequence="31"
                  groups="group_charge_produce"/>

        <record id="mrp_waiting_rework" model="ir.actions.act_window">
            <field name="name">Waiting Rework Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'waiting_rework')]</field>
            <field name="context">{'state':'waiting_rework'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>

        <menuitem id="menu_mrp_waiting_rework"
                  name="Waiting Rework Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_waiting_rework"
                  sequence="31"
                  groups="group_charge_produce"/>


        <record id="mrp_rework_ing" model="ir.actions.act_window">
            <field name="name">Reworking Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'rework_ing')]</field>
            <field name="context">{'state':'rework_ing'}</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>

        <menuitem id="menu_mrp_rework_ing"
                  name="Reworking Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_rework_ing"
                  sequence="31"
                  groups="group_charge_produce"/>


        <record id="mrp_done" model="ir.actions.act_window">
            <field name="name">Done Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'done')]</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_done"
                  name="Done Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_done"
                  sequence="32"/>

        <record id="mrp_cancelled" model="ir.actions.act_window">
            <field name="name">Cancelled Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">mrp.production</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar,pivot,graph,gantt</field>
            <field name="view_id" eval="False"/>
            <field name="search_view_id" ref="view_mrp_production_filter"/>
            <field name="domain">[('state','=', 'cancel')]</field>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a manufacturing order.
                </p>
                <p>
                    A manufacturing order, based on a bill of materials, will
                    consume raw materials and produce finished products.
                </p>
                <p>
                    Manufacturing orders are usually proposed automatically based
                    on customer requirements or automated rules like the minimum
                    stock rule.
                </p>
            </field>
        </record>
        <menuitem id="menu_mrp_cancelled"
                  name="Cancelled Orders"
                  parent="mrp.menu_mrp_manufacturing"
                  action="mrp_cancelled"
                  sequence="32"/>


        <record id="action_picking_tree_outgoing" model="ir.actions.act_window">
            <field name="name">Transfer Out</field>
            <field name="res_model">stock.picking</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar</field>
            <field name="domain">[('picking_type_code','=', 'outgoing')]</field>
            <field name="context">{
                'contact_display': 'partner_address',
                }
            </field>
            <field name="search_view_id" ref="stock.view_picking_internal_search"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click here to create a new transfer.
                </p>
                <p>
                    You can either do it immediately or mark it as Todo for future processing. Use your scanner to
                    validate the transferred quantity quicker.
                </p>
            </field>
        </record>

        <record id="action_picking_tree_incoming" model="ir.actions.act_window">
            <field name="name">Transfer In</field>
            <field name="res_model">stock.picking</field>
            <field name="type">ir.actions.act_window</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,kanban,form,calendar</field>
            <field name="domain">[('picking_type_code','=', 'incoming')]</field>
            <field name="context">{
                'contact_display': 'partner_address',
                }
            </field>
            <field name="search_view_id" ref="stock.view_picking_internal_search"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click here to create a new transfer.
                </p>
                <p>
                    You can either do it immediately or mark it as Todo for future processing. Use your scanner to
                    validate the transferred quantity quicker.
                </p>
            </field>
        </record>

        <menuitem id="outgoing_picking" name="Transfer Out" parent="stock.menu_stock_warehouse_mgmt" sequence="3"
                  action="action_picking_tree_outgoing" groups="stock.group_stock_manager,stock.group_stock_user"/>
        <menuitem id="incoming_picking" name="Transfer In" parent="stock.menu_stock_warehouse_mgmt" sequence="4"
                  action="action_picking_tree_incoming" groups="stock.group_stock_manager,stock.group_stock_user"/>


        <record id="hr_hr_employee_view_form_worker" model="ir.ui.view">
            <field name="name">hr.hr.employee.view.form2</field>
            <field name="model">hr.employee</field>
            <field name="inherit_id" ref="hr.view_employee_form"/>
            <field name="arch" type="xml">
                <xpath expr="//field[@name='category_ids']" position="before">
                    <group>
                        <field name="is_worker" string="Is Worker"/>
                    </group>
                </xpath>
            </field>
        </record>


        <record id="account_multi_handle_worker_form_view" model="ir.ui.view">
            <field name="name">multi.handle.worker.form</field>
            <field name="model">multi.handle.worker</field>
            <field name="arch" type="xml">
                <form string="批量确认是否是员工">
                    <p class="oe_grey">
                        是否将选中员工设置为产线工人？
                    </p>
                    <footer>
                        <button string="确定" name="action_ok" type="object" default_focus="1"
                                class="btn-primary"/>
                        <button string="Cancel" class="btn-default" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>


        <act_window id="action_multi_create_qrcode"
                    multi="True"
                    key2="client_action_multi" name="批量设置员工"
                    res_model="multi.handle.worker" src_model="hr.employee"
                    view_mode="form" target="new" view_type="form"/>


        <record id="account_multi_set_mto" model="ir.ui.view">
            <field name="name">multi.set.mto.form</field>
            <field name="model">multi.set.mto</field>
            <field name="arch" type="xml">
                <form string="批量确认设置成按订单生成">
                    <p class="oe_grey">
                        是否将产品批量设置成 按订单生成
                    </p>
                    <footer>
                        <button string="打勾按订单生成" name="action_ok" type="object" default_focus="1"
                                context="{'is_checked':1}"
                                class="btn-primary"/>
                        <button string="取消按订单生成" name="action_ok" type="object" default_focus="1"
                                context="{'is_checked':0}"
                                class="btn-primary"/>
                        <button string="Cancel" class="btn-default" special="cancel"/>
                    </footer>
                </form>
            </field>
        </record>


        <act_window id="action_multi_set_mto"
                    multi="True"
                    key2="client_action_multi" name="批量设置"
                    res_model="multi.set.mto" src_model="product.template"
                    view_mode="form" target="new" view_type="form"/>


        <record id="make_by_mrp_purchase_form_action" model="ir.actions.act_window">
            <field name="name">Orders Make By MRP</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.order</field>
            <field name="view_mode">tree,kanban,form,pivot,graph,calendar</field>
            <field name="domain">[('state','=',('make_by_mrp'))]</field>
            <field name="view_ids" eval="[(5,0,0),
            (0,0,{'view_mode':'tree', 'view_id': ref('linkloving_purchase.purchase_order_tree_ll')}),
            (0,0,{'view_mode':'form', 'view_id': ref('purchase.purchase_order_form')})]"/>

            <field name="search_view_id" ref="purchase.view_purchase_order_filter"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a quotation that will be converted into a purchase order.
                </p>
                <p>
                    Use this menu to search within your purchase orders by
                    references, vendor, products, etc. For each purchase order,
                    you can track the related discussion with the vendor, control
                    the products received and control the vendor bills.
                </p>
            </field>
        </record>

        <menuitem
                action="make_by_mrp_purchase_form_action" id="menu_purchase_make_by_mrp"
                parent="linkloving_purchase.menu_sale_order_list" name="MRP生成订单" sequence="16"/>


        <record id="mrp_production_tree_view_ll" model="ir.ui.view">
            <field name="name">mrp.production.tree</field>
            <field name="model">mrp.production</field>
            <field name="inherit_id" ref="mrp.mrp_production_tree_view"/>
            <field name="arch" type="xml">

                <xpath expr="//field[@name='product_uom_id']" position="replace">
                </xpath>

                <xpath expr="//field[@name='availability']" position="replace">
                    <field name="availability" string="材料状况"/>
                </xpath>
                <xpath expr="//field[@name='origin']" position="replace">
                    <field name="total_spent_money" string="加工总费用"/>
                </xpath>
            </field>
        </record>

        <record id="purchase.purchase_form_action" model="ir.actions.act_window">
            <field name="name">Purchase Orders</field>
            <field name="type">ir.actions.act_window</field>
            <field name="res_model">purchase.order</field>
            <field name="view_mode">tree,kanban,form,pivot,graph,calendar</field>
            <field name="context">{'search_default_todo':1, 'show_purchase': True}</field>
            <field name="domain">[('state','not in',('draft','sent','bid', 'confirmed','make_by_mrp'))]</field>
            <field name="search_view_id" ref="purchase.view_purchase_order_filter"/>
            <field name="help" type="html">
                <p class="oe_view_nocontent_create">
                    Click to create a quotation that will be converted into a purchase order.
                </p>
                <p>
                    Use this menu to search within your purchase orders by
                    references, vendor, products, etc. For each purchase order,
                    you can track the related discussion with the vendor, control
                    the products received and control the vendor bills.
                </p>
            </field>
        </record>


        <record id="linkloving_purchase_order_form_make_by_mrp" model="ir.ui.view">
            <field name="name">purchase.order.form</field>
            <field name="model">purchase.order</field>
            <field name="inherit_id" ref="purchase.purchase_order_form"/>
            <field name="arch" type="xml">
                <xpath expr="//button[@name='action_rfq_send']" position="after">
                    <button name="change_state_to_rfq" string="确认生成采购询价单" type="object"
                            class="btn-primary oe_highlight"
                            attrs="{'invisible':[('state', 'not in', ('make_by_mrp'))]}"/>
                </xpath>
            </field>
        </record>
    </data>
</openerp>